<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TypeDrop — Daily AI-Generated TypeScript Challenges</title>
  <meta name="description" content="A fresh TypeScript challenge every day, generated by AI. Focus on the type system, not algorithms. Open in StackBlitz or clone locally — no accounts, no setup.">
  <meta property="og:title" content="TypeDrop — Daily AI-Generated TypeScript Challenges">
  <meta property="og:description" content="A fresh TypeScript challenge every day, generated by AI. Focus on the type system, not algorithms. Open in StackBlitz or clone locally — no accounts, no setup.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://niltonheck.github.io/TypeDrop/">
  <meta property="og:image" content="https://niltonheck.github.io/TypeDrop/misc/og-image.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="TypeDrop — Daily AI-Generated TypeScript Challenges">
  <meta name="twitter:description" content="A fresh TypeScript challenge every day, generated by AI. Focus on the type system, not algorithms. Open in StackBlitz or clone locally — no accounts, no setup.">
  <meta name="twitter:image" content="https://niltonheck.github.io/TypeDrop/misc/og-image.png">
  <link rel="icon" href="misc/favicon.svg" type="image/svg+xml">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Permanent+Marker&display=swap">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/fontsource/fonts/0x-proto@latest/latin-400-normal.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/fontsource/fonts/0x-proto@latest/latin-700-normal.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.min.css">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <a href="#challenge" class="skip-link">Skip to challenge</a>
  <main>
    <header>
      <h1>TypeDrop</h1>
      <p class="tagline">A new TypeScript challenge every day. Sharpen your types.</p>
    </header>

    <div class="about-callout">
      <p><strong>TypeDrop</strong> delivers a fresh TypeScript challenge every day, generated by AI. Pick a challenge, open it in StackBlitz (preferred) or CodeSandbox (or clone it locally), and make the tests pass. No accounts, no setup — just you and the type system.</p>
      <p><a href="https://github.com/niltonheck/typedrop" target="_blank" rel="noopener noreferrer">Learn more on GitHub &rarr;</a></p>
    </div>

    <!-- CHALLENGE_START -->
    <section class="challenge-card">
      <div class="challenge-header">
        <span class="challenge-date">2026-02-19</span>
        <span class="badge hard">Hard</span>
      </div>
      <h2>Typed Middleware Pipeline with Retry &amp; Cancellation</h2>
      <p>You're building an internal HTTP gateway layer that processes outgoing requests through a chain of typed middleware (auth injection, logging, rate-limit headers). Each middleware can transform the request context, short-circuit with a typed error, and the pipeline runner supports per-request cancellation and automatic retry with exponential back-off.</p>
      <div class="challenge-goals">
        <h3>Goals</h3>
        <ul>
          <li>Define `Middleware`, `Executor`, `RetryPolicy`, and `PipelineOptions` as fully-typed generic aliases/interfaces with no `any` or `never` placeholders.</li>
          <li>Implement `runPipeline` with a recursive `dispatch` function that threads context through middlewares, supports short-circuiting, and retries failed attempts using the supplied `RetryPolicy` with exponential back-off.</li>
          <li>Implement the three middleware factories (`withBearerAuth`, `withRequestLogger`, `withRateLimitHeader`) and the `exponentialBackoff` helper so all five test cases pass.</li>
          <li>Implement `sleep` so it respects an optional `AbortSignal`, rejecting immediately with the signal's reason when already aborted or when aborted mid-sleep.</li>
        </ul>
      </div>
      <div class="code-block">
        <div class="code-block-header">
          <span class="dot red"></span>
          <span class="dot yellow"></span>
          <span class="dot green"></span>
          <span class="code-block-title">challenge.ts</span>
        </div>
        <pre><code class="language-typescript">
// Key types at a glance

type Milliseconds = number &amp; { readonly __brand: &quot;Milliseconds&quot; };

interface PipelineContext&lt;TBody = unknown&gt; {
  readonly requestId: string;
  url: string;
  method: &quot;GET&quot; | &quot;POST&quot; | &quot;PUT&quot; | &quot;PATCH&quot; | &quot;DELETE&quot;;
  headers: Record&lt;string, string&gt;;
  body: TBody | undefined;
  meta: Record&lt;string, unknown&gt;;
}

type PipelineResult&lt;TResponse, TError&gt; =
  | { readonly kind: &quot;success&quot;; readonly response: TResponse;
      readonly durationMs: Milliseconds; readonly attempts: number }
  | { readonly kind: &quot;failure&quot;; readonly error: TError;
      readonly durationMs: Milliseconds; readonly attempts: number };

// TODO (a) — fill in the body:
type Middleware&lt;TBody, TResponse, TError&gt; = never;

// TODO (f) — implement this:
async function runPipeline&lt;TBody, TResponse, TError&gt;(
  options: PipelineOptions&lt;TBody, TResponse, TError&gt;
): Promise&lt;PipelineResult&lt;TResponse, TError&gt;&gt; { ... }
</code></pre>
      </div>
      <details class="challenge-hints-details">
        <summary>Hints (click to reveal)</summary>
      <div class="challenge-hints">
        <h3>Hints</h3>
        <ul>
          <li>For `Middleware&lt;TBody, TResponse, TError&gt;`, the `next` parameter's type is the same async function shape as the middleware itself minus the `next` arg — write it as an inline function type `(ctx: PipelineContext&lt;TBody&gt;) =&gt; Promise&lt;PipelineResult&lt;TResponse, TError&gt;&gt;`.</li>
          <li>In `runPipeline`, track `startTime = Date.now()` before the attempt loop and compute `durationMs` only once when you're ready to return — the `durationMs` fields from the executor are intentionally ignored at the pipeline level.</li>
          <li>For `sleep` + `AbortSignal`, register a one-shot `'abort'` event listener and also check `signal.aborted` synchronously at the top of the function before creating the timeout.</li>
        </ul>
      </div>
      </details>
      <div class="challenge-docs">
        <h3>Useful resources</h3>
        <ul>
          <li><a href="https://www.typescriptlang.org/docs/handbook/2/generics.html" target="_blank" rel="noopener noreferrer">TypeScript Handbook — Generics</a></li>
          <li><a href="https://www.typescriptlang.org/docs/handbook/2/conditional-types.html" target="_blank" rel="noopener noreferrer">TypeScript Handbook — Conditional Types &amp; infer</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Web/API/AbortController" target="_blank" rel="noopener noreferrer">MDN — AbortSignal &amp; AbortController</a></li>
          <li><a href="https://www.typescriptlang.org/docs/handbook/utility-types.html" target="_blank" rel="noopener noreferrer">TypeScript Handbook — Utility Types (Extract, Record, Pick…)</a></li>
        </ul>
      </div>
      <div class="cta-row">
        <a class="cta-button cta-primary" href="https://stackblitz.com/github/niltonheck/typedrop/tree/challenge/2026-02-19" target="_blank" rel="noopener noreferrer">
          <img class="sb-icon" src="https://cdn.simpleicons.org/stackblitz/e0e0e0" alt=""> StackBlitz
        </a>
        <a class="cta-button" href="https://codesandbox.io/p/devbox/github/niltonheck/typedrop/tree/challenge/2026-02-19" target="_blank" rel="noopener noreferrer">
          <img class="csb-icon" src="https://cdn.simpleicons.org/codesandbox/e0e0e0" alt=""> CodeSandbox
        </a>
      </div>
      <div class="clone-section">
        <h3>Or clone locally</h3>
        <div class="clone-box">
          <code id="clone-cmd">git clone -b challenge/2026-02-19 https://github.com/niltonheck/typedrop.git</code>
          <button class="clone-copy-btn" onclick="navigator.clipboard.writeText(document.getElementById('clone-cmd').textContent).then(()=>{this.textContent='Copied!';this.classList.add('copied');setTimeout(()=>{this.textContent='Copy';this.classList.remove('copied')},2000)})">Copy</button>
        </div>
      </div>
    </section>
    <!-- CHALLENGE_END -->

    <footer>
      <p>
        Challenges are AI-generated and open source.
        <a href="https://github.com/niltonheck/typedrop" target="_blank" rel="noopener noreferrer">View on GitHub</a>
        &middot;
        <a href="archive.html">Archive</a>
      </p>
      <p>
        Built with <svg class="inline-icon heart-icon" viewBox="0 0 24 24" fill="currentColor" aria-label="love"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg> and <img src="https://cdn.simpleicons.org/anthropic/d4a27f" alt="Claude" class="inline-icon"> from <a href="https://www.youtube.com/watch?v=s9hl8i_yeUw" target="_blank" rel="noopener noreferrer"><img src="misc/pe-flag.jpg" alt="Peru" class="flag-icon"></a> by
        <a href="https://github.com/niltonheck" target="_blank" rel="noopener noreferrer">@niltonheck</a>
      </p>
      <p class="footer-note">
        This site uses <a href="https://www.goatcounter.com/" target="_blank" rel="noopener noreferrer">GoatCounter</a>, an open-source, privacy-friendly analytics tool, purely to satisfy curiosity about page visits. No personal data is collected, no cookies are used, and nothing is shared or used for training.
      </p>
    </footer>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-typescript.min.js"></script>
  <script data-goatcounter="https://niltonheck.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>
</body>
</html>
